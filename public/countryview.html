<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>나라별 전체 정보 페이지</title>
    <link rel="stylesheet" type="text/css" href="./style.css">
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">

    <!-- Semantic -->
    <link rel="stylesheet" type="text/css" href="semantic/semantic.min.css">
    <!--배경 색을 지정함-->
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"
        integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="semantic/semantic.min.js"></script>

    <!-- update the version number as needed -->
    <script defer src="/__/firebase/8.6.2/firebase-app.js"></script>
    <!-- include only the Firebase features as you need -->
    <script defer src="/__/firebase/8.6.2/firebase-database.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.3/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/topojson/1.6.9/topojson.min.js"></script>
    <script src="datamaps.world.min.js"></script>

    <script>
        var check_country = new Array;
        function checkCountry(countryName) {
            var isTrue;
            for (var i = 0; i < check_country.length; i++) {
                if (countryName == check_country[i]) {
                    isTrue = false;
                    return Boolean(isTrue);
                }
            }
            isTrue = true;
            return Boolean(isTrue);
        }

        $(document).ready(function () {
            $.getJSON('./Json/recentNews.json', function (json) {

                for (var counter = 0; counter < json.length; counter++) {
                    if (checkCountry(json[counter].countryName)) {
                        $('#search-select').append(`<option value=` + json[counter].countryEnName + '>' + json[counter].countryName + '</option>');
                        check_country.push(json[counter].countryName);
                    }
                }
            });

            $('#search-select')
                .dropdown()
                ;
        });
    </script>

</head>

<body style="background-color: #FAFAFA;">
    <!-- 사이드 메뉴 -->
    <div id="side_menu">
        <ul>
            <li><a class="home_btn" href="./index.html"><img src="./image/earth-globe.png"
                        style="margin-right: 13px; height: 35px;">요<span style="color: #F17F42;">지</span>경</a></li>
            <hr style="margin-top: 15px; margin-left: 20px; margin-right: 30px;">

            <!-- 드랍 다운 -->
            <div style="margin-left: 30px; margin-top: 25px;">
                <select class="ui search selection dropdown" id="search-select" onchange="setDropValue()">
                    <option value="">나라 이름</option>
                </select>
            </div>

            <li><a class="vaccine_btn" href="./vaccine.html"><img src="./image/syringe.png"
                        style="margin-right: 12px; height: 25px;">백신
                    정보</a></li>
            <li><a class="flight_btn" href="./flight.html"><img src="./image/airplane.png"
                        style="margin-right: 10px; height: 28px;">운항 정보</a></li>
            <li><a class="recent_btn" href="./recent.html"><img src="./image/earth.png"
                        style="margin-right: 15px; height: 22px;">나라별 최신 정보</a></li>
        </ul>
    </div>

    <div id="wrap">
        <div class="ui segment" id="vaccineSegment" style="margin-right: 80px;">

        </div>
        <div class="ui segment" id="recentSegment" style="margin-right: 80px;">
            <div style="align-items: center; height: 50px;display: flex; align-items: center;">
                <div id="table_name2" style=" width: 100%; margin-bottom: 20px;margin-left: 10px">
                    <h2 style="display: inline-block; color: #F17F42">최신 </h2>
                    <h2 style="display: inline-block">정보</h2>
                </div>
            </div>
            <table class="ui celled table" id="rejsonTable">
                <thead>
                    <tr>
                        <th>
                            <font style="vertical-align: inherit;">
                                <font style="vertical-align: inherit;">국가이름</font>
                            </font>
                        </th>
                        <th>
                            <font style="vertical-align: inherit;">
                                <font style="vertical-align: inherit;">제목</font>
                            </font>
                        </th>
                        <th>
                            <font style="vertical-align: inherit;">
                                <font style="vertical-align: inherit;">작성일</font>
                            </font>
                        </th>
                    </tr>
                </thead>
            </table>
        </div>
        <div class="ui segment" id="flightSegment" style="margin-right: 80px;">
            <div style="align-items: center; height: 50px;display: flex; align-items: center;">
                <div id="table_name" style=" width: 100%; margin-bottom: 20px;margin-left: 10px">
                    <h2 style="display: inline-block; color: #F17F42">운항 </h2>
                    <h2 style="display: inline-block">정보</h2>
                </div>
            </div>
            <table class="ui celled table" id="fljsonTable">
                <thead>
                    <tr>
                        <th>
                            <font style="vertical-align: inherit;">
                                <font style="vertical-align: inherit;">ID</font>
                            </font>
                        </th>
                        <th>
                            <font style="vertical-align: inherit;">
                                <font style="vertical-align: inherit;">국가이름</font>
                            </font>
                        </th>
                        <th>
                            <font style="vertical-align: inherit;">
                                <font style="vertical-align: inherit;">제목</font>
                            </font>
                        </th>
                        <th>
                            <font style="vertical-align: inherit;">
                                <font style="vertical-align: inherit;">작성일</font>
                            </font>
                        </th>
                    </tr>
                </thead>
            </table>
        </div>
    </div>

    <script type="text/javascript">
        $(document).ready(function () {
            var para = document.location.href.split("=");
            console.log(para[1]);

            $.getJSON('./Json/recentNews.json', function (json) {
                $('#rejsonTable').append("<tbody>");
                for (var counter = 0; counter < json.length; counter++) {
                    if (json[counter].countryEnName === para[1]) {
                        $('#rejsonTable').append("<tr><td>" + json[counter].countryName + `</td><td><a onclick="setRecentValue(` + `${json[counter].id})` + `">` + json[counter].title + "</a></td><td>" + json[counter].wrtDt + "</td></tr>");
                    }
                }
                $('#rejsonTable').append("</tbody>");
                $('#rejsonTable').DataTable();
            });

            $.getJSON('./Json/flight.json', function (json) {
                $('#fljsonTable').append("<tbody>");
                for (var counter = 0; counter < json.length; counter++) {
                    if (json[counter].country_eng_nm === para[1]) {
                        $('#fljsonTable').append("<tr><td>" + json[counter].id + "</td><td>" + json[counter].country_nm + `</td><td><a onclick="setChildValue(` + `${json[counter].id})` + `">` + json[counter].title + "</a></td><td>" + json[counter].wrt_dt + "</td></tr>");
                    }
                }
                $('#fljsonTable').append("</tbody>");
                $('#fljsonTable').DataTable();
            });
        });

        function setRecentValue(index) {
            window.location.href = "flightview.html?index=" + index;
        }

        function setFlightValue(index) {
            window.location.href = "flightview.html?index=" + index;
        }
        function setDropValue() {
            var x = document.getElementById("search-select").value;
            window.location.href = "countryview.html?country=" + x;
        }
    </script>

</body>

</html>